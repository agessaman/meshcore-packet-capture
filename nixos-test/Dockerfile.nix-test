FROM ubuntu:22.04

# Install dependencies
RUN apt-get update && apt-get install -y \
    curl \
    git \
    xz-utils \
    sudo \
    && rm -rf /var/lib/apt/lists/*

# Install Nix
RUN sh <(curl -L https://nixos.org/nix/install) --daemon --no-daemon

# Enable flakes
RUN mkdir -p /root/.config/nix && \
    echo "experimental-features = nix-command flakes" >> /root/.config/nix/nix.conf

# Set up environment
ENV PATH="/root/.nix-profile/bin:/nix/var/nix/profiles/default/bin:$PATH"

WORKDIR /workspace

CMD ["/bin/bash"]

